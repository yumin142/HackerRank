create table scoretable
(
    event_id         integer,
    participant_name varchar(100),
    score            real
);


INSERT INTO scoretable (event_id, participant_name, score) VALUES (1, 'Gus', 9);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (2, 'Summer', 1.6);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (2, 'Dona', 8.9);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (1, 'Sue', 9);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (1, 'Jason', 4.2);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (3, 'Jason', 7.1);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (6, 'Ernestine', 10);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (3, 'Gina', 10);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (5, 'Angel', 8.9);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (3, 'Kenton', 5.2);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (2, 'Dane', 9.1);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (1, 'Rhoda', 7);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (6, 'Carla', 2.4);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (2, 'Leanne', 3.9);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (6, 'Heriberto', 3.1);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (1, 'Maryellen', 3.4);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (4, 'Nina', 8.7);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (2, 'Donnell', 7.2);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (6, 'Annabelle', 3.9);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (6, 'Leonor', 5);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (1, 'Summer', 5.8);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (2, 'Meredith', 3.5);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (2, 'Annabelle', 7.7);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (4, 'Donnell', 10);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (4, 'Summer', 2);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (6, 'Rosa', 3.1);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (2, 'Angel', 7.7);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (2, 'Trenton', 3.8);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (3, 'Esteban', 8.1);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (2, 'Leila', 4.3);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (2, 'Demetrius', 10);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (1, 'Pedro', 10);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (3, 'Lucio', 5.8);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (1, 'Rhoda', 4);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (1, 'Maryellen', 3.7);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (6, 'Rosa', 7.1);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (3, 'Rosa', 8.4);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (2, 'Heriberto', 8);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (2, 'Maryellen', 4.7);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (4, 'Meredith', 9.1);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (5, 'Cornelia', 7.6);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (4, 'Laurie', 5);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (2, 'Carla', 4.7);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (3, 'Rosa', 7.4);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (2, 'Joey', 2);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (4, 'Young', 9.9);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (3, 'Angel', 2);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (4, 'Annabelle', 1.1);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (3, 'Forest', 5.1);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (6, 'Demetrius', 7.6);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (3, 'Annabelle', 10);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (1, 'Beatriz', 7.3);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (3, 'Summer', 6.9);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (3, 'Sheldon', 3.8);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (4, 'Nina', 8);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (1, 'Gus', 4.9);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (2, 'Dwain', 4.3);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (2, 'Pedro', 8.6);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (3, 'Wilber', 10);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (5, 'Esteban', 10);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (1, 'Ernestine', 1.3);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (4, 'Vanessa', 10);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (4, 'Dane', 8.9);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (1, 'Audra', 7.3);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (2, 'Eric', 6);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (6, 'Nina', 1.1);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (5, 'Gus', 6.3);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (6, 'Pedro', 2.7);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (6, 'Young', 7.4);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (4, 'Shari', 7.9);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (1, 'Wilber', 9.7);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (1, 'Lela', 7.8);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (4, 'Pedro', 8.4);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (1, 'Eliza', 10);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (1, 'Demetrius', 3.8);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (6, 'Carla', 6);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (3, 'Shari', 7.8);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (1, 'Audra', 5.7);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (3, 'Stewart', 10);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (6, 'Young', 4.1);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (1, 'Dwain', 4.5);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (2, 'Annabelle', 6.3);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (1, 'Shari', 9.4);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (4, 'Leila', 7.3);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (2, 'Tamra', 9.6);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (6, 'Holmes', 10);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (4, 'Pedro', 10);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (4, 'Forest', 3.1);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (3, 'Israel', 6.2);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (2, 'Wilber', 9);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (2, 'Jason', 3.5);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (1, 'Dane', 3.7);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (3, 'Eliza', 2.3);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (2, 'Cornelia', 10);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (1, 'Gus', 8.3);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (4, 'Israel', 7.2);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (4, 'Joey', 8.7);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (6, 'Gina', 6.8);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (3, 'Israel', 9.5);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (3, 'Leila', 3.6);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (4, 'Maryellen', 8.1);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (6, 'Israel', 1.9);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (4, 'Sue', 1.2);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (3, 'Tamra', 1.2);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (3, 'Heriberto', 1.2);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (4, 'Donnell', 10);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (4, 'Gina', 6.4);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (5, 'Summer', 1.6);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (2, 'Joey', 7.6);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (5, 'Beatriz', 5.1);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (2, 'Dona', 3.8);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (5, 'Joey', 9.6);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (5, 'Holmes', 8.1);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (1, 'Sheldon', 3.9);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (6, 'Eva', 8.3);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (4, 'Trenton', 9.9);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (3, 'Rosa', 2.2);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (3, 'Jason', 5.9);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (1, 'Dwain', 3.2);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (6, 'Nina', 2.2);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (6, 'Dane', 6);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (5, 'Beatriz', 8.3);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (2, 'Israel', 4);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (1, 'Rosa', 6.4);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (5, 'Trenton', 5);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (6, 'Meredith', 3);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (4, 'Heriberto', 3.7);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (2, 'Maryellen', 5.7);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (2, 'Rhoda', 4);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (4, 'Kenton', 9.1);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (4, 'Audra', 2.4);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (3, 'Dane', 4.3);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (6, 'Maryellen', 4);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (5, 'Maryellen', 4.3);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (6, 'Sue', 9.8);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (3, 'Donnell', 9);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (6, 'Jason', 7.1);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (2, 'Vanessa', 9.2);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (2, 'Esteban', 5);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (6, 'Annabelle', 8.1);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (4, 'Angel', 3.4);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (6, 'Lucio', 6.5);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (1, 'Lucio', 2.5);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (5, 'Dwain', 7);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (1, 'Eric', 5.1);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (6, 'Doug', 8.6);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (6, 'Tamra', 5.9);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (3, 'Dane', 4.7);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (3, 'Trenton', 4.5);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (1, 'Meredith', 2);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (1, 'Joey', 6.2);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (6, 'Nina', 5.4);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (5, 'Eric', 3);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (6, 'Trenton', 10);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (1, 'Gus', 6.4);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (3, 'Eric', 5.5);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (3, 'Leanne', 4.5);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (1, 'Jason', 9.5);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (3, 'Cornelia', 9.2);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (3, 'Eliza', 2.5);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (4, 'Trenton', 1.6);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (6, 'Gina', 9.7);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (2, 'Stewart', 6.9);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (3, 'Joey', 9.4);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (6, 'Donnell', 10);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (5, 'Doug', 7.7);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (3, 'Nina', 3.9);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (1, 'Darrick', 2.5);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (4, 'Angel', 9.9);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (2, 'Leila', 1.4);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (6, 'Sue', 9.7);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (2, 'Stewart', 2.5);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (4, 'Vanessa', 1.3);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (3, 'Audra', 8.6);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (6, 'Demetrius', 7.8);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (3, 'Heriberto', 7.6);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (1, 'Carla', 6);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (2, 'Tamra', 8.3);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (4, 'Demetrius', 3.1);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (3, 'Eva', 8);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (2, 'Leila', 8.4);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (5, 'Forest', 4.1);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (3, 'Beatriz', 2.1);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (1, 'Leila', 4.8);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (6, 'Eliza', 9);
INSERT INTO scoretable (event_id, participant_name, score) VALUES (2, 'Leonor', 5.4);


select  event_id,
        group_concat(first) as 'first', 
        group_concat(second) as 'second',
        group_concat(third) as 'third'
from (

        select  event_id,
                case when ranking = 1 then participant_name end as 'first', 
                case when ranking = 2 then participant_name end as 'second',
                case when ranking = 3 then participant_name end as 'third'
        from (
    
                select  event_id, 
                        participant_name,
                        max(score) as ms,
                        dense_rank() over (
                            partition by event_id
                            order by max(score) desc
                            ) as ranking
                from scoretable
                group by event_id, participant_name
                order by event_id, ms desc, participant_name asc

            ) as base0
            
    ) as base1
    
group by event_id